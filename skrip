local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local VirtualInputManager = nil
pcall(function() VirtualInputManager = game:GetService("VirtualInputManager") end)
local VirtualUser = nil
pcall(function() VirtualUser = game:GetService("VirtualUser") end)

local LocalPlayer = Players.LocalPlayer

-- GUI Container
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui
ScreenGui.Name = "CardCounterUI"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Main Frame
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 280, 0, 200)
Frame.Position = UDim2.new(0.5, -140, 0.2, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BackgroundTransparency = 0.1
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Frame.Parent = ScreenGui

local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 12)

local UIStroke = Instance.new("UIStroke", Frame)
UIStroke.Thickness = 1.5
UIStroke.Color = Color3.fromRGB(80, 80, 80)

-- Title
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -60, 0, 30)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "ðŸŽ´ Card Counter"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = Frame

-- Auto Button
local AutoButton = Instance.new("TextButton")
AutoButton.Size = UDim2.new(0, 28, 0, 28)
AutoButton.Position = UDim2.new(1, -60, 0, 3)
AutoButton.BackgroundColor3 = Color3.fromRGB(230, 230, 230)
AutoButton.Text = "A"
AutoButton.TextColor3 = Color3.fromRGB(0, 0, 0)
AutoButton.Font = Enum.Font.GothamBold
AutoButton.TextSize = 18
AutoButton.Parent = Frame
local AutoUICorner = Instance.new("UICorner", AutoButton)
AutoUICorner.CornerRadius = UDim.new(1, 0)

-- Auto Indicator
local Indicator = Instance.new("Frame")
Indicator.Size = UDim2.new(0, 10, 0, 10)
Indicator.Position = UDim2.new(1, -80, 0, 10)
Indicator.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
Indicator.BorderSizePixel = 0
Indicator.Parent = Frame
local IndicatorCorner = Instance.new("UICorner", Indicator)
IndicatorCorner.CornerRadius = UDim.new(1, 0)

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 28, 0, 28)
CloseButton.Position = UDim2.new(1, -30, 0, 3)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 18
CloseButton.Parent = Frame
local CloseUICorner = Instance.new("UICorner", CloseButton)
CloseUICorner.CornerRadius = UDim.new(1, 0)
CloseButton.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
	if script then script:Destroy() end
end)

-- Minimize Button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Size = UDim2.new(0, 28, 0, 28)
MinimizeButton.Position = UDim2.new(1, -90, 0, 3)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 18
MinimizeButton.Parent = Frame
local MinimizeUICorner = Instance.new("UICorner", MinimizeButton)
MinimizeUICorner.CornerRadius = UDim.new(1, 0)

local Minimized = false
MinimizeButton.MouseButton1Click:Connect(function()
	Minimized = not Minimized
	if Minimized then
		Frame:TweenSize(UDim2.new(0, 280, 0, 35), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.3, true)
	else
		Frame:TweenSize(UDim2.new(0, 280, 0, 200), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.3, true)
	end
end)

-- Recommendation
local Recommendation = Instance.new("TextLabel")
Recommendation.Size = UDim2.new(1, -20, 0, 30)
Recommendation.Position = UDim2.new(0, 10, 0, 40)
Recommendation.BackgroundTransparency = 1
Recommendation.Font = Enum.Font.GothamBold
Recommendation.TextSize = 26
Recommendation.TextColor3 = Color3.fromRGB(255, 255, 255)
Recommendation.Parent = Frame

-- Info
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Size = UDim2.new(1, -20, 1, -100)
InfoLabel.Position = UDim2.new(0, 10, 0, 80)
InfoLabel.BackgroundTransparency = 1
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.TextSize = 15
InfoLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
InfoLabel.TextXAlignment = Enum.TextXAlignment.Left
InfoLabel.TextYAlignment = Enum.TextYAlignment.Top
InfoLabel.TextWrapped = true
InfoLabel.RichText = true
InfoLabel.Parent = Frame

-- FPS & Ping
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(1, -20, 0, 20)
StatusLabel.Position = UDim2.new(0, 10, 1, -25)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextSize = 14
StatusLabel.TextColor3 = Color3.fromRGB(150, 200, 255)
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = Frame

-- Auto Logic
local AutoOn = false
local AutoLoopThread = nil
local AutoAvailable = (VirtualInputManager ~= nil) or (VirtualUser ~= nil)

local function setAutoAppearance(on)
	local goalColor = on and Color3.fromRGB(50, 200, 50) or Color3.fromRGB(200, 50, 50)
	TweenService:Create(Indicator, TweenInfo.new(0.25), {BackgroundColor3 = goalColor}):Play()
end

-- Hotkey Toggle (F4)
UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end
	if input.KeyCode == Enum.KeyCode.F4 then
		AutoOn = not AutoOn
		setAutoAppearance(AutoOn)
	end
end)

AutoButton.MouseButton1Click:Connect(function()
	AutoOn = not AutoOn
	setAutoAppearance(AutoOn)
end)

-- Update FPS & Ping
RunService.RenderStepped:Connect(function()
	local fps = math.floor(1 / RunService.RenderStepped:Wait())
	local ping = math.floor(Players.LocalPlayer:GetNetworkPing() * 1000)
	StatusLabel.Text = string.format("FPS: %d  |  Ping: %d ms", fps, ping)
end)

-- Update Advisor (panggil kode updateAdvisor lama kamu di sini)
-- RunService.RenderStepped:Connect(updateAdvisor)
