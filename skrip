local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local VirtualInputManager = pcall(function() return game:GetService("VirtualInputManager") end)
local VirtualUser = pcall(function() return game:GetService("VirtualUser") end)

local LocalPlayer = Players.LocalPlayer

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.Name = "CardCounter"

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 280, 0, 190)
Frame.Position = UDim2.new(0.5, -140, 0.2, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Frame.Parent = ScreenGui

-- UI Aesthetic
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 10)
local Stroke = Instance.new("UIStroke", Frame)
Stroke.Color = Color3.fromRGB(80,80,80)
Stroke.Thickness = 1.5

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -60, 0, 30)
Title.Position = UDim2.new(0, 10, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "Card Counter"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = Frame

-- Minimize Button
local MinButton = Instance.new("TextButton")
MinButton.Size = UDim2.new(0, 25, 0, 25)
MinButton.Position = UDim2.new(1, -85, 0, 3)
MinButton.BackgroundColor3 = Color3.fromRGB(70, 70, 200)
MinButton.Text = "-"
MinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinButton.Font = Enum.Font.GothamBold
MinButton.TextSize = 18
MinButton.Parent = Frame
Instance.new("UICorner", MinButton).CornerRadius = UDim.new(0, 6)

-- Auto Button
local AutoButton = Instance.new("TextButton")
AutoButton.Size = UDim2.new(0, 25, 0, 25)
AutoButton.Position = UDim2.new(1, -56, 0, 3)
AutoButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
AutoButton.Text = "A"
AutoButton.TextColor3 = Color3.fromRGB(0, 0, 0)
AutoButton.Font = Enum.Font.GothamBold
AutoButton.TextSize = 18
AutoButton.Parent = Frame
Instance.new("UICorner", AutoButton).CornerRadius = UDim.new(0, 6)

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Position = UDim2.new(1, -28, 0, 3)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 18
CloseButton.Parent = Frame
Instance.new("UICorner", CloseButton).CornerRadius = UDim.new(0, 6)

CloseButton.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
end)

-- Recommendation
local Recommendation = Instance.new("TextLabel")
Recommendation.Size = UDim2.new(1, -20, 0, 35)
Recommendation.Position = UDim2.new(0, 10, 0, 35)
Recommendation.BackgroundTransparency = 1
Recommendation.Font = Enum.Font.GothamBold
Recommendation.TextSize = 28
Recommendation.TextColor3 = Color3.fromRGB(255, 255, 255)
Recommendation.Text = "Waiting..."
Recommendation.Parent = Frame

-- Info
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Size = UDim2.new(1, -20, 1, -75)
InfoLabel.Position = UDim2.new(0, 10, 0, 70)
InfoLabel.BackgroundTransparency = 1
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.TextSize = 16
InfoLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
InfoLabel.TextWrapped = true
InfoLabel.TextXAlignment = Enum.TextXAlignment.Left
InfoLabel.TextYAlignment = Enum.TextYAlignment.Top
InfoLabel.RichText = true
InfoLabel.Text = "Loading..."
InfoLabel.Parent = Frame

-- History Panel
local History = {}
local function addHistory(text)
	table.insert(History, 1, text)
	if #History > 5 then table.remove(History, #History) end
	InfoLabel.Text = table.concat(History, "\n")
end

-- Minimize Function
local Minimized = false
MinButton.MouseButton1Click:Connect(function()
	Minimized = not Minimized
	local goalSize = Minimized and UDim2.new(0, 280, 0, 40) or UDim2.new(0, 280, 0, 190)
	TweenService:Create(Frame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = goalSize}):Play()
end)

-- Auto Toggle
local AutoOn = false
AutoButton.MouseButton1Click:Connect(function()
	AutoOn = not AutoOn
	local color = AutoOn and Color3.fromRGB(50,200,50) or Color3.fromRGB(255,255,255)
	local textColor = AutoOn and Color3.fromRGB(255,255,255) or Color3.fromRGB(0,0,0)
	TweenService:Create(AutoButton, TweenInfo.new(0.2), {BackgroundColor3 = color, TextColor3 = textColor}):Play()
	addHistory("[AUTO] " .. (AutoOn and "ENABLED" or "DISABLED"))
end)

-- Shortcut Toggle (press M)
UserInputService.InputBegan:Connect(function(input, gpe)
	if not gpe and input.KeyCode == Enum.KeyCode.M then
		AutoButton:Activate()
	end
end)

-- Example Fake Update (replace dengan updateAdvisor asli)
RunService.Heartbeat:Connect(function()
	-- Simulasi update
	Recommendation.Text = math.random() > 0.5 and "TAKE" or "HOLD"
	Recommendation.TextColor3 = (Recommendation.Text == "TAKE") and Color3.fromRGB(50,200,50) or Color3.fromRGB(200,50,50)
	addHistory("Rekomendasi: " .. Recommendation.Text)
end)
